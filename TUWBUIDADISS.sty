%% 
%% Template for dissertation and diploma thesis 
%% at the faculty of civil engineering, TU Wien
%% 
%% Created 2022-10-01
%% Christian Schranz, Sebastian Pech
%% tested for pdflatex
%% 
\ProvidesPackage{TUWBUIDADISS}[2022/09/01]

\addtokomafont{captionlabel}{\bfseries}

\KOMAoptions{chapterprefix=false}
\KOMAoptions{parskip=false,headinclude=true,
captions=tableheading,numbers=noenddot}

% Custom Abstand nach Absätzen
\setlength{\parskip}{0.3\baselineskip}

\renewcommand*{\chaptermarkformat}{%
  \thechapter\autodot\enskip%
}  % no "Chapter" (or "Kapitel" in header)

\RequirePackage[utf8]{inputenc}
\RequirePackage[T1]{fontenc}

\RequirePackage{lmodern}
\RequirePackage[babel]{microtype}     % improves the micro-typographic layout
\RequirePackage[english,ngerman]{babel} %% englisch and austrian language
\PassOptionsToPackage{table}{xcolor}
\RequirePackage{xcolor} %% improvement to the color package, included by pdfx 
% muss jetzt vor pdfx geladen werden

\input{glyphtounicode.tex}    %Part of modern distribution
\input{glyphtounicode-cmr.tex}     %Additionnal glyph: You must grab it from pdfx package
\pdfgentounicode=1
\pdfinterwordspaceon
\RequirePackage[a-2u,pdf17]{pdfx}
\pdfomitcharset 1
\RequirePackage{colorprofiles}
\RequirePackage{cmap}

\hypersetup{ % Setzt einige Werte die in den Eigenschaften des PDF gespeichert sind.
  bookmarksnumbered,
%   % pdfdisplaydoc = true,
   colorlinks, % Für Druck auf "false" setzen!
   linkcolor={black}, % auch keine grellen Rahmen im View
   citecolor={black},
   urlcolor={black}
}

%% Absatzkontrolle
\clubpenalty10000
\widowpenalty10000
\displaywidowpenalty=10000

\RequirePackage{graphicx} 
%includehead/includefoot evtl wegtun (macht, dass Kopfzeile/Fußzeile Abstand von oben/unten hat)
\RequirePackage[left=3.5cm, right=1.5cm, top=2.0cm, bottom=2.0cm,includehead,includefoot]{geometry}

%% Kopf- und Fußzeilen
\RequirePackage[
headsepline,
automark
]{scrlayer-scrpage}

\pagestyle{scrheadings}
\clearpairofpagestyles
\addtokomafont{pageheadfoot}{\small} % Schriftgröße für Kopf- und Fußzeilen

\newcommand{\setAuthor}[1]{\markboth{#1}{#1}}
%\ihead{\headmark}
\ihead{\centering \thesistitle}
\ifoot{\leftmark} % Linksbündig Name des Autors im Kapitel
\ofoot{\thepage} % Seitennummerierung rechtsbündig

%% Schriftgröße für Überschriften
\RedeclareSectionCommand[
beforeskip=1ex plus 0.2ex minus 0.2ex,
afterskip=1em,
font=\normalfont\fontsize{16}{20}\selectfont\bfseries,
afterindent=false
]{section}

\RedeclareSectionCommand[
beforeskip=0.5ex plus 0.2ex minus 0.2ex,
afterskip=1em,
font=\normalfont\fontsize{15}{16}\selectfont\bfseries,
afterindent=false
]{subsection}

\let\oldsubsection\subsection
\renewcommand{\subsection}{\clearpage\oldsubsection}

\RedeclareSectionCommand[
beforeskip=0.5ex plus 0.2ex minus 0.2ex,
afterskip=0.6em,
font=\normalfont\fontsize{14}{16}\selectfont\bfseries,
afterindent=false
]{subsubsection}

\RedeclareSectionCommand[
beforeskip=1.5ex plus 0.2ex minus 0.2ex,
afterskip=0.3em,
font=\normalfont\fontsize{13}{14}\selectfont\bfseries,
afterindent=false
]{paragraph}



% Schriftart / Font wird für das ganze Dokument gesetzt
\RequirePackage{helvet}  % Use helvet package instead of uarial (Arial)
\renewcommand{\rmdefault}{phv} % Helvetica as the default Roman font
\renewcommand{\sfdefault}{phv} % Helvetica as the default sans-serif font
\addtokomafont{captionlabel}{\bfseries}

\RequirePackage{ragged2e,tabularx}

%Zeilenabstand
\RequirePackage{setspace}
\onehalfspacing

% Falls man Word equivalent will. Ist eigentlich mehr als 1,5 Zeilenabstand
%\setstretch{1.5}

% Für große Abstände
%\doublespacing

%Durchgehende Nummerierung für Abbildungen und Tabellen
\counterwithout{figure}{chapter}
\counterwithout{table}{chapter}

\RequirePackage{glossaries}

\RequirePackage[absolute]{textpos} %% for positioning the tu-logo

\RequirePackage[list=true]{subcaption}

\RequirePackage{mathtools} %% extension of amsmath (also loads amstext)
\RequirePackage{amssymb}   %% for complex formulas
%Correct UTF8 mapping for ams fonts
\ifdefined\pdffontattr% \ifdefined is part of the e-TeX extension, which is part of any modern LaTeX compiler.
  \immediate\pdfobj stream file {umsa.cmap}
  {\usefont{U}{msa}{m}{n}\pdffontattr\font{/ToUnicode \the\pdflastobj\space 0 R}}
  \immediate\pdfobj stream file {umsb.cmap}
  {\usefont{U}{msb}{m}{n}\pdffontattr\font{/ToUnicode \the\pdflastobj\space 0 R}}
\fi
\RequirePackage{xfrac}  %% diagonals fractions - e.g. numbers
\RequirePackage{siunitx} %% SI Units

\RequirePackage{booktabs} %% for better looking tables 



\RequirePackage{longtable}
\RequirePackage[para,flushleft]{threeparttable}
\RequirePackage{multirow}

\RequirePackage{url} %% links inside the document as well as to websites

\RequirePackage{pdfpages} %% to include pdf pages

\RequirePackage{textcomp} %% additional symbols
\RequirePackage{marvosym} %% additional symbols
\RequirePackage{pifont}   %% additional symbols
\RequirePackage{eurosym} %% for correct Euro-Symbol with \officialeuro{}

\RequirePackage[babel,austrian=quotes,english=american]{csquotes}   %% context sensitives quotations

\RequirePackage{xspace}  %% for intelligent spacing after commands \xspace

\RequirePackage{enumitem}  %% to customize itemize, enumerate, description

\RequirePackage{listings} %% syntax highlighting - for program code


% Eigene Sprachabhängige Begriffe
\renewcaptionname{ngerman}{\tablename}{Tab.}
\renewcaptionname{ngerman}{\figurename}{Abb.}
\renewcaptionname{ngerman}{\bibname}{Literaturverzeichnis}
\renewcaptionname{ngerman}{\abstractname}{Kurzfassung}

\renewcaptionname{english}{\tablename}{Tab.}
\renewcaptionname{english}{\figurename}{Fig.}

%% Typografische Einstellungen zu Gleitobjekten
\renewcommand{\floatpagefraction}{0.6}
\renewcommand{\textfraction}{0.15}
\renewcommand{\topfraction}{0.8}
\renewcommand{\bottomfraction}{0.5}
\setcounter{topnumber}{3}
\setcounter{totalnumber}{5}

%Minted Code Highlighting
\RequirePackage{minted}
\usemintedstyle{colorful} 
\usepackage{xcolor}
% python, console, cpp, csharp, java, json, tex

\newmintedfile[pythonfile]{python}{
	frame=lines,
	framesep=2mm,
	baselinestretch=1.2,
	linenos,
	xleftmargin=4mm,
	xrightmargin=.25in,
	breaklines=true,
	tabsize=4,
	baselinestretch=1 
}
\newminted{python}{
	frame=lines,
	framesep=2mm,
	baselinestretch=1.2,
	linenos,
	xleftmargin=4mm,
	xrightmargin=.25in,
	breaklines=true,
	tabsize=4,
	baselinestretch=1 
}
\newminted{json}{
	frame=lines,
	framesep=2mm,
	baselinestretch=1.2,
	linenos,
	xleftmargin=4mm,
	xrightmargin=.25in,
	breaklines=true,
	tabsize=4,
	baselinestretch=1 
}
\newminted[jsonfile]{json}{
	frame=lines,
	framesep=2mm,
	baselinestretch=1.2,
	linenos,
	xleftmargin=4mm,
	xrightmargin=.25in,
	breaklines=true,
	tabsize=4,
	baselinestretch=1 
}


%% Customize Code Listing
\lstset{
	basicstyle = \ttfamily,%\footnotesize
	keywordstyle=\color{blue}\bfseries,
	tabsize=4,
	breaklines=true,
	showstringspaces = false,
	upquote = true,
	xleftmargin=4mm,
	xrightmargin=.25in,
	aboveskip=15pt,
	belowskip=12pt,
	belowcaptionskip=12pt,
	numbers=left,
	numberstyle=\tiny,
	frame=tb,
	moredelim=**[is][\color{blue}]{@}{@}
} 
\lstset{literate=%
   {Ö}{{\"O}}1
   {Ä}{{\"A}}1
   {Ü}{{\"U}}1
   {ß}{{\ss}}1
   {ü}{{\"u}}1
   {ä}{{\"a}}1
   {ö}{{\"o}}1
}
\renewcommand{\lstlistingname}{Program Code}

% TITELSEITE KONFIGURIEREN
\RequirePackage{ifthen}

\renewcommand{\maketitle}{% Prozentzeichen NICHT WEGLÖSCHEN!
\begin{titlepage}
\begin{figure}
	\centering
	\includegraphics[width=3.61cm]{Bilder/HTL_Dornbirn_Logo}
\end{figure}

\begin{center}
\vspace{4ex} %vertikaler abstand zwischen Absätzen
{\fontsize{20}{24}\selectfont HTL Dornbirn}
\\[0.6ex] %vertikaler abstand zwischen Zeilen
{\fontsize{10}{12}\selectfont \textbf{Höhere Lehranstalt für Wirtschaftsingenieurwesen}}
\\[-0.2ex]
{\fontsize{10}{12}\selectfont Ausbildungsschwerpunkt Betriebsinformatik}
\\[16ex]
{\fontsize{36}{46}\selectfont \textbf{Diplomarbeit}}
\\[4ex]
\begin{spacing}{1.5}
	{\fontsize{20}{28}\selectfont \thesistitle}
\end{spacing}
\end{center}

\vfill

\begin{minipage}[t]{0.6\textwidth}
	\textbf{Ausgeführt im Schuljahr 2023/24 von:}\\[2ex]
	\begin{tabularx}{\linewidth}{l>{\hspace{20pt}}X} 
		Lukas Fenkart & 5bWI \\[0.2ex]
		Luca Jerome Mangeng & 5bWI \\[0.2ex]
		Damiano Pezzè & 5bWI \\[0.2ex]
		Martin Schneider & 5bWI \\[0.2ex]
	\end{tabularx}
\end{minipage}
\hfill % This adds a horizontal space between the two minipages
\begin{minipage}[t]{0.3\textwidth}
	\textbf{Betreuer:}\\[2ex]
	Prof. DI Klaus Battlogg \\[2ex]
	Ing. Köldorfer Simon, BSc
\end{minipage}

\vspace{5ex}

Dornbirn, am \today
\end{titlepage}}%

